
import sys

cd630_genes = set(['272563.8.peg.1522','272563.8.peg.1925','272563.8.peg.3384','272563.8.peg.2816','272563.8.peg.1472','272563.8.peg.318','272563.8.peg.1671','272563.8.peg.2144','272563.8.peg.1906','272563.8.peg.2775','272563.8.peg.1498','272563.8.peg.3805','272563.8.peg.3114','272563.8.peg.1110','272563.8.peg.3156','272563.8.peg.871','272563.8.peg.2189','272563.8.peg.927','272563.8.peg.1240','272563.8.peg.2852','272563.8.peg.3377','272563.8.peg.14','272563.8.peg.24','272563.8.peg.3559','272563.8.peg.9','272563.8.peg.13','272563.8.peg.2710','272563.8.peg.2183','272563.8.peg.1314','272563.8.peg.2596','272563.8.peg.3838','272563.8.peg.3388','272563.8.peg.3083','272563.8.peg.10','272563.8.peg.348','272563.8.peg.1360','272563.8.peg.1361','272563.8.peg.3664','272563.8.peg.1339','272563.8.peg.3717','272563.8.peg.1238','272563.8.peg.1243','272563.8.peg.1283','272563.8.peg.1673','272563.8.peg.106','272563.8.peg.1365','272563.8.peg.2607','272563.8.peg.2736','272563.8.peg.2464','272563.8.peg.1109','272563.8.peg.837','272563.8.peg.3770','272563.8.peg.2711','272563.8.peg.202','272563.8.peg.1401','272563.8.peg.2898','272563.8.peg.3406','272563.8.peg.2138','272563.8.peg.2660','272563.8.peg.3209','272563.8.peg.3558','272563.8.peg.1647','272563.8.peg.618','272563.8.peg.1645','272563.8.peg.1563','272563.8.peg.1730','272563.8.peg.1562','272563.8.peg.620','272563.8.peg.1714','272563.8.peg.2961','272563.8.peg.1630','272563.8.peg.1625','272563.8.peg.2315','272563.8.peg.2624','272563.8.peg.1523','272563.8.peg.2392','272563.8.peg.1908','272563.8.peg.2488','272563.8.peg.2918','272563.8.peg.2299','272563.8.peg.1087','272563.8.peg.2921','272563.8.peg.2520','272563.8.peg.3024','272563.8.peg.1099','272563.8.peg.2922','272563.8.peg.1088','272563.8.peg.2916','272563.8.peg.2923','272563.8.peg.2302','272563.8.peg.121','272563.8.peg.1086','272563.8.peg.3343','272563.8.peg.2926','272563.8.peg.821','272563.8.peg.2911','272563.8.peg.2913','272563.8.peg.1993','272563.8.peg.2888',
	'272563.8.peg.1023','272563.8.peg.1370','272563.8.peg.2862','272563.8.peg.1394','272563.8.peg.2247','272563.8.peg.1264','272563.8.peg.3425','272563.8.peg.2117','272563.8.peg.1776','272563.8.peg.3380','272563.8.peg.123','272563.8.peg.2489','272563.8.peg.2697','272563.8.peg.2734','272563.8.peg.3375','272563.8.peg.2713','272563.8.peg.896','272563.8.peg.2794','272563.8.peg.895','272563.8.peg.2798','272563.8.peg.894','272563.8.peg.2795','272563.8.peg.893','272563.8.peg.2796','272563.8.peg.2009','272563.8.peg.2010','272563.8.peg.3588','272563.8.peg.353','272563.8.peg.2355','272563.8.peg.1855','272563.8.peg.3325','272563.8.peg.3763','272563.8.peg.2983','272563.8.peg.1677','272563.8.peg.1678','272563.8.peg.1897','272563.8.peg.2160','272563.8.peg.759','272563.8.peg.2559','272563.8.peg.408','272563.8.peg.854','272563.8.peg.3282','272563.8.peg.3260','272563.8.peg.3241','272563.8.peg.3270','272563.8.peg.2882','272563.8.peg.2194','272563.8.peg.3328','272563.8.peg.2181','272563.8.peg.2187','272563.8.peg.2188','272563.8.peg.2195','272563.8.peg.3582','272563.8.peg.760','272563.8.peg.766','272563.8.peg.1734','272563.8.peg.1735','272563.8.peg.1389','272563.8.peg.2161','272563.8.peg.2137','272563.8.peg.3115','272563.8.peg.1670','272563.8.peg.411','272563.8.peg.1473','272563.8.peg.1743','272563.8.peg.2022','272563.8.peg.1040','272563.8.peg.2035','272563.8.peg.2034','272563.8.peg.3728','272563.8.peg.2647','272563.8.peg.1929','272563.8.peg.1930','272563.8.peg.2906','272563.8.peg.2715','272563.8.peg.2871','272563.8.peg.194','272563.8.peg.195','272563.8.peg.1886','272563.8.peg.2663','272563.8.peg.1778','272563.8.peg.3596','272563.8.peg.3584','272563.8.peg.1233','272563.8.peg.3228','272563.8.peg.3557','272563.8.peg.1421','272563.8.peg.1186','272563.8.peg.3259','272563.8.peg.3269','272563.8.peg.409','272563.8.peg.3240','272563.8.peg.3223','272563.8.peg.856','272563.8.peg.3281','272563.8.peg.3239','272563.8.peg.3011','272563.8.peg.3275','272563.8.peg.1623','272563.8.peg.2383',
	'272563.8.peg.224','272563.8.peg.3279','272563.8.peg.225','272563.8.peg.226','272563.8.peg.3578','272563.8.peg.2286','272563.8.peg.2818','272563.8.peg.1830','272563.8.peg.1085','272563.8.peg.3583','272563.8.peg.2778','272563.8.peg.105','272563.8.peg.1994','272563.8.peg.3642','272563.8.peg.1924','272563.8.peg.921','272563.8.peg.922','272563.8.peg.3683','272563.8.peg.2223','272563.8.peg.2946','272563.8.peg.2853','272563.8.peg.2962','272563.8.peg.3616','272563.8.peg.2384','272563.8.peg.2622','272563.8.peg.774','272563.8.peg.2306','272563.8.peg.1910','272563.8.peg.1912','272563.8.peg.3229','272563.8.peg.2693','272563.8.peg.757','272563.8.peg.354','272563.8.peg.2013','272563.8.peg.3111','272563.8.peg.2243','272563.8.peg.1519','272563.8.peg.2800','272563.8.peg.1111','272563.8.peg.205','272563.8.peg.238','272563.8.peg.1521','272563.8.peg.1250','272563.8.peg.2321','272563.8.peg.2820','272563.8.peg.1101','272563.8.peg.2451','272563.8.peg.3804','272563.8.peg.2449','272563.8.peg.2450','272563.8.peg.2754','272563.8.peg.838','272563.8.peg.2804','272563.8.peg.1657','272563.8.peg.2303','272563.8.peg.1610','272563.8.peg.2613','272563.8.peg.3438','272563.8.peg.2278','272563.8.peg.3244','272563.8.peg.1786','272563.8.peg.1554','272563.8.peg.3135','272563.8.peg.1556','272563.8.peg.2482','272563.8.peg.3134','272563.8.peg.1555','272563.8.peg.1052','272563.8.peg.1927','272563.8.peg.1916','272563.8.peg.725','272563.8.peg.217','272563.8.peg.724','272563.8.peg.2806','272563.8.peg.2977','272563.8.peg.472','272563.8.peg.1045','272563.8.peg.3427','272563.8.peg.1551','272563.8.peg.1593','272563.8.peg.570','272563.8.peg.3174','272563.8.peg.2632','272563.8.peg.1403','272563.8.peg.2709','272563.8.peg.1842','272563.8.peg.3711','272563.8.peg.2940','272563.8.peg.3645','272563.8.peg.1602','272563.8.peg.3416','272563.8.peg.3414','272563.8.peg.3421','272563.8.peg.3415','272563.8.peg.1224','272563.8.peg.2531','272563.8.peg.1655','272563.8.peg.2839','272563.8.peg.60','272563.8.peg.2136',
	'272563.8.peg.2821','272563.8.peg.2860','272563.8.peg.1744','272563.8.peg.139','272563.8.peg.1382','272563.8.peg.3323','272563.8.peg.423','272563.8.peg.2033','272563.8.peg.2032','272563.8.peg.2680','272563.8.peg.1055','272563.8.peg.1054','272563.8.peg.3799','272563.8.peg.3595','272563.8.peg.414','272563.8.peg.3601','272563.8.peg.3621','272563.8.peg.1406','272563.8.peg.3249','272563.8.peg.3150','272563.8.peg.1775','272563.8.peg.3208','272563.8.peg.610','272563.8.peg.1282','272563.8.peg.2636','272563.8.peg.2840','272563.8.peg.3656','272563.8.peg.77','272563.8.peg.1373','272563.8.peg.113','272563.8.peg.3857','272563.8.peg.1312','272563.8.peg.1527','272563.8.peg.1570','272563.8.peg.78','272563.8.peg.1928','272563.8.peg.2833','272563.8.peg.493','272563.8.peg.320','272563.8.peg.2872','272563.8.peg.57','272563.8.peg.3598','272563.8.peg.1628','272563.8.peg.3147','272563.8.peg.3000','272563.8.peg.3001','272563.8.peg.3146','272563.8.peg.295','272563.8.peg.3435','272563.8.peg.1175','272563.8.peg.796','272563.8.peg.770','272563.8.peg.55','272563.8.peg.1731','272563.8.peg.3591','272563.8.peg.198','272563.8.peg.52','272563.8.peg.2394','272563.8.peg.2442','272563.8.peg.2444','272563.8.peg.50','272563.8.peg.2396','272563.8.peg.2395','272563.8.peg.1137','272563.8.peg.2443','272563.8.peg.51','272563.8.peg.2910','272563.8.peg.1587','272563.8.peg.3148','272563.8.peg.2999','272563.8.peg.923','272563.8.peg.146','272563.8.peg.1481','272563.8.peg.1708','272563.8.peg.47','272563.8.peg.2218','272563.8.peg.3250','272563.8.peg.2446','272563.8.peg.3273','272563.8.peg.2304','272563.8.peg.1676','272563.8.peg.43',
	'272563.8.peg.911','272563.8.peg.1726','272563.8.peg.1725','272563.8.peg.1724','272563.8.peg.1727','272563.8.peg.229','272563.8.peg.2458','272563.8.peg.2230','272563.8.peg.805','272563.8.peg.3736','272563.8.peg.3324','272563.8.peg.129','272563.8.peg.2496','272563.8.peg.3830','272563.8.peg.2708','272563.8.peg.1211','272563.8.peg.1926','272563.8.peg.425','272563.8.peg.2156','272563.8.peg.2721','272563.8.peg.3245','272563.8.peg.3472','272563.8.peg.755','272563.8.peg.1774','272563.8.peg.2282','272563.8.peg.2400','272563.8.peg.2955','272563.8.peg.1124','272563.8.peg.3606','272563.8.peg.3510','272563.8.peg.2606','272563.8.peg.1479','272563.8.peg.122','272563.8.peg.2369','272563.8.peg.2499','272563.8.peg.3858','272563.8.peg.89','272563.8.peg.3409','272563.8.peg.1347','272563.8.peg.94','272563.8.peg.83','272563.8.peg.1235','272563.8.peg.2253','272563.8.peg.69','272563.8.peg.95','272563.8.peg.1383','272563.8.peg.80','272563.8.peg.3708','272563.8.peg.2360','272563.8.peg.746','272563.8.peg.22','272563.8.peg.2968','272563.8.peg.103','272563.8.peg.1221','272563.8.peg.112','272563.8.peg.2733','272563.8.peg.2867','272563.8.peg.3837','272563.8.peg.3722','272563.8.peg.120','272563.8.peg.2741','272563.8.peg.734','272563.8.peg.119','272563.8.peg.96','272563.8.peg.93','272563.8.peg.1597','272563.8.peg.3730','272563.8.peg.1322','272563.8.peg.721','272563.8.peg.97','272563.8.peg.2685','272563.8.peg.88','272563.8.peg.91','272563.8.peg.74','272563.8.peg.92','272563.8.peg.111','272563.8.peg.2567','272563.8.peg.62','272563.8.peg.73','272563.8.peg.2552','272563.8.peg.86','272563.8.peg.2866','272563.8.peg.101','272563.8.peg.100','272563.8.peg.98','272563.8.peg.1318','272563.8.peg.2595','272563.8.peg.99','272563.8.peg.735','272563.8.peg.85','272563.8.peg.114','272563.8.peg.2644','272563.8.peg.109','272563.8.peg.3833','272563.8.peg.110','272563.8.peg.87',
	'272563.8.peg.1219','272563.8.peg.601','272563.8.peg.90','272563.8.peg.722','272563.8.peg.2551','272563.8.peg.79','272563.8.peg.84','272563.8.peg.3839','272563.8.peg.102','272563.8.peg.3653','272563.8.peg.756','272563.8.peg.2351','272563.8.peg.196','272563.8.peg.2197','272563.8.peg.2198','272563.8.peg.2182','272563.8.peg.2436','272563.8.peg.3253','272563.8.peg.2699','272563.8.peg.1411','272563.8.peg.2448','272563.8.peg.1796','272563.8.peg.1524','272563.8.peg.1629','272563.8.peg.164','272563.8.peg.237','272563.8.peg.513','272563.8.peg.239','272563.8.peg.2889','272563.8.peg.2248','272563.8.peg.3235','272563.8.peg.1042','272563.8.peg.1041','272563.8.peg.1043','272563.8.peg.3580','272563.8.peg.2447','272563.8.peg.2720','272563.8.peg.804','272563.8.peg.2532','272563.8.peg.801','272563.8.peg.2536','272563.8.peg.240','272563.8.peg.2071','272563.8.peg.2487','272563.8.peg.1895','272563.8.peg.128','272563.8.peg.2988','272563.8.peg.3333','272563.8.peg.514','272563.8.peg.2441','272563.8.peg.2393','272563.8.peg.2440','272563.8.peg.2830','272563.8.peg.2528','272563.8.peg.1917','272563.8.peg.241','272563.8.peg.879','272563.8.peg.1904','272563.8.peg.3322','272563.8.peg.1567','272563.8.peg.3434','272563.8.peg.330','272563.8.peg.1034','272563.8.peg.2865','272563.8.peg.1873','272563.8.peg.3613','272563.8.peg.3218','272563.8.peg.1062','272563.8.peg.476','272563.8.peg.1852','272563.8.peg.1279','272563.8.peg.872','272563.8.peg.907','272563.8.peg.1668','272563.8.peg.1667','272563.8.peg.1669','272563.8.peg.518','272563.8.peg.1132','272563.8.peg.309','272563.8.peg.3429','272563.8.peg.308','272563.8.peg.3430','272563.8.peg.517','272563.8.peg.1131','272563.8.peg.307','272563.8.peg.516','272563.8.peg.3432','272563.8.peg.1130','272563.8.peg.305',
	'272563.8.peg.3431','272563.8.peg.304','272563.8.peg.515','272563.8.peg.1128','272563.8.peg.56','272563.8.peg.3633','272563.8.peg.3632','272563.8.peg.3636','272563.8.peg.3635','272563.8.peg.3634','272563.8.peg.3640','272563.8.peg.3641','272563.8.peg.242','272563.8.peg.585','272563.8.peg.1284','272563.8.peg.3585','272563.8.peg.2899','272563.8.peg.2901','272563.8.peg.1777','272563.8.peg.3138','272563.8.peg.3139','272563.8.peg.3628','272563.8.peg.2133','272563.8.peg.2370','272563.8.peg.321','272563.8.peg.323','272563.8.peg.322','272563.8.peg.1453','272563.8.peg.778','272563.8.peg.3332','272563.8.peg.1740','272563.8.peg.1191','272563.8.peg.2568','272563.8.peg.2455','272563.8.peg.2698','272563.8.peg.2356','272563.8.peg.3725','272563.8.peg.1231','272563.8.peg.3759','272563.8.peg.3761','272563.8.peg.3760','272563.8.peg.3762','272563.8.peg.365','272563.8.peg.1641','272563.8.peg.2229','272563.8.peg.2631','272563.8.peg.903','272563.8.peg.3204','272563.8.peg.1405','272563.8.peg.1574','272563.8.peg.3565','272563.8.peg.2586','272563.8.peg.2085','272563.8.peg.3600','272563.8.peg.1781','272563.8.peg.1782','272563.8.peg.3846','272563.8.peg.1344','272563.8.peg.3176','272563.8.peg.45','272563.8.peg.48','272563.8.peg.46','272563.8.peg.3321','272563.8.peg.3329','272563.8.peg.2190','272563.8.peg.3682','272563.8.peg.2550','272563.8.peg.2793','272563.8.peg.1732','272563.8.peg.473','272563.8.peg.2861','272563.8.peg.3390','272563.8.peg.2558','272563.8.peg.1922','272563.8.peg.636','272563.8.peg.930','272563.8.peg.2803','272563.8.peg.1056','272563.8.peg.2020','272563.8.peg.1517','272563.8.peg.1518','272563.8.peg.3777','272563.8.peg.1652','272563.8.peg.2907','272563.8.peg.2333','272563.8.peg.2617','272563.8.peg.2791','272563.8.peg.2790','272563.8.peg.3202','272563.8.peg.3247','272563.8.peg.3171','272563.8.peg.2634','272563.8.peg.2588',
	'272563.8.peg.3732','272563.8.peg.2981','272563.8.peg.2980','272563.8.peg.2452','272563.8.peg.2456','272563.8.peg.3439','272563.8.peg.1810','272563.8.peg.466','272563.8.peg.1525','272563.8.peg.1923','272563.8.peg.2438','272563.8.peg.3624','272563.8.peg.2439','272563.8.peg.3625','272563.8.peg.3768','272563.8.peg.1815','272563.8.peg.3769','272563.8.peg.1266','272563.8.peg.1046','272563.8.peg.3464','272563.8.peg.42','272563.8.peg.1407','272563.8.peg.243','272563.8.peg.3272','272563.8.peg.2829','272563.8.peg.2215','272563.8.peg.206','272563.8.peg.135','272563.8.peg.3602','272563.8.peg.929','272563.8.peg.1881','272563.8.peg.2716','272563.8.peg.3153','272563.8.peg.1626','272563.8.peg.3394','272563.8.peg.3392','272563.8.peg.3396','272563.8.peg.3393','272563.8.peg.294','272563.8.peg.3116','272563.8.peg.866','272563.8.peg.2777','272563.8.peg.924','272563.8.peg.1831','272563.8.peg.818','272563.8.peg.1399','272563.8.peg.3130','272563.8.peg.2719','272563.8.peg.2638','272563.8.peg.831','272563.8.peg.2470','272563.8.peg.1768','272563.8.peg.3177','272563.8.peg.2316','272563.8.peg.2139','272563.8.peg.1586','272563.8.peg.1457','272563.8.peg.1458','272563.8.peg.2521','272563.8.peg.928','272563.8.peg.3718','272563.8.peg.2135','272563.8.peg.3225','272563.8.peg.3012','272563.8.peg.153','272563.8.peg.901','272563.8.peg.3820','272563.8.peg.3192','272563.8.peg.3825','272563.8.peg.3224','272563.8.peg.3009','272563.8.peg.151','272563.8.peg.3822','272563.8.peg.902','272563.8.peg.3823','272563.8.peg.3226','272563.8.peg.152','272563.8.peg.3013','272563.8.peg.1679','272563.8.peg.795','272563.8.peg.3436','272563.8.peg.1176','272563.8.peg.2227','272563.8.peg.1769','272563.8.peg.2471','CD630_12590','CD630_07500','CD630_10040','CD630_10030','CD630_23710','CD630_01790','CD630_12250',
	'CD630_24170','CD630_24180','CD630_10100','CD630_22770','CD630_00450','CD630_35150','CD630_30140','CD630_30150','CD630_30130','K07406','CD630_08760','CD630_08730','CD630_06820','K12658','CD630_17760','SAMEA3375161_04237','CD630_01120','CD630_21990','CD630_21991','CD630_01540','CD630_01530','CD630_23800','CD630_32440','CD630_23540','CD630_03940','CD630_03980','CD630_03970','CD630_03950','CD630_03960','K05709','K05708','K00529','CD630_01550','CD630_21960','CD630_23420','CD630_23410','CD630_10540','CD630_23390','CD630_26550','CD630_02440','CD630_26510'])

â€‹suffix = str(sys.argv[1]).split('.')[-1]
outFasta = str(sys.argv[1]).rstrip('fastnx') + 'format.' + suffix
outFasta = open(outFasta, 'w')

included = 0
with open(sys.argv[1], 'r') as inFasta:

	firstLine = inFasta.readline().split('|')
	patric_id = firstLine[0]
	gene = firstLine[4].split('[')[0].strip().replace(' ','_')
	if patric_id in cd630_genes:
		included = 1
		entry = '>' + patric_id + '|' + gene
		outFasta.write(entry)

	sequence = ''
	for line in inFasta:

		if line[0] != '>' and included == 1:
			sequence += line.strip().upper()
			included = 0
		else:
			if patric_id in cd630_genes:
				included = 1
				entry = '>' + patric_id + '|' + gene
				outFasta.write(entry)


outFasta.close()
